# Aanbieden: Bulk verwerking

Bulk-verwerking is niet iets dat ingebakken is in REST. Wegens volume van de data en de verwerkingstijd, is gekozen voor een asynchrone oplossing.
Toevoegen en verwijderen is toegestaan.
Updaten is *niet* toegestaan. Dit om een aantal redenen:

- Metingen behoren immutable te zijn
- Updaten van data, helemaal indien deze in een bepaalde structuur staan, is zeer inefficient en kan vaak niet in een bulk-operatie plaatsvinden.
- Ook de historie bijhouden wordt ingewikkeld.

Moeten metingen worden gemuteerd, dan dienen deze eerst verwijderd te worden, en daarna opnieuw ge&iuml;mporteerd.

Authenticeren gaat met de OAUTH2 Client Credential Flow, die wordt gebruikt als machine-to-machine koppeling.
De API implementatie dient het inlog-account te associÃ«ren met een bepaalde organisatie en op basis daarvan te valideren of het verzoek terecht is.

*Data aanleveren moet laagdrempelig gebeuren om draagvlak te krijgen en behouden.*
Mogelijk is het IM Metingen formaat of het O&M formaat te complex en leidt tot een groter datavolume.
We kunnen kijken naar vereenvoudigde formaten: een timeseries formaat en een monster-gebaseerd formaat. Voor timeseries zou het bekende DD-API formaat, met kleine aanpassingen, kunnen worden gebruikt. Voor de andere metingen kunnen we een formaat distilleren die dichter staat bij O&M.

Verwerking zal niet meteen gebeuren. Daarom kan de client een status bij de server opvragen.

Valideren is de eerste fase van verwerking. Pas wanneer de bulk-content volledig gevalideerd is, kan er daadwerkelijk worden ge&iuml;mporteerd.

[Fouten in validatie](validatie.md#validatiefouten) worden ook gestandaardiseerd.

## Bulk data toevoegen

[![Bulk toevoegen](https://mermaid.ink/img/pako:eNqNksFqwzAMhl9F-LRB-wI5FLImYz002ZpksJKLZqupaWJ3jlK2lb77vHmFQUmZTuLXr8-GX0chrSIRiZ7eBjKSEo2Nw6424GuPjrXUezQM81aT4Uu9IHcgF_Tgmc5mQYzgdWh3oE1P7nczs0zgdLNlsBs4256x1Yq8CeSfV8LU0wI2giqLq_IhXy3WafI_nCO5ZTIjvPt8dbdIkjS7BotbeAfffVrakQFE09DBITZqhFrmOSzj7AVW6VOVFmVx9asBDGypZ88eYcbzefpYpskNOzQ9StbWTLW6rY2YiI5ch1r5EI_f67XgLXVUi8i3Ct2uFrU5eR8ObIsPI0XEbqCJGPYK-Ry4iDbY9l4lpdm6ZbiKn-OYCB_02tqz5_QFys2-Cw)](https://mermaid.live/edit#pako:eNqNksFqwzAMhl9F-LRB-wI5FLImYz002ZpksJKLZqupaWJ3jlK2lb77vHmFQUmZTuLXr8-GX0chrSIRiZ7eBjKSEo2Nw6424GuPjrXUezQM81aT4Uu9IHcgF_Tgmc5mQYzgdWh3oE1P7nczs0zgdLNlsBs4256x1Yq8CeSfV8LU0wI2giqLq_IhXy3WafI_nCO5ZTIjvPt8dbdIkjS7BotbeAfffVrakQFE09DBITZqhFrmOSzj7AVW6VOVFmVx9asBDGypZ88eYcbzefpYpskNOzQ9StbWTLW6rY2YiI5ch1r5EI_f67XgLXVUi8i3Ct2uFrU5eR8ObIsPI0XEbqCJGPYK-Ry4iDbY9l4lpdm6ZbiKn-OYCB_02tqz5_QFys2-Cw)

## Bulk verwijderen

[![Bulk verwijderen](https://mermaid.ink/img/pako:eNqNk99rwjAQx_-VI08OFIaPfRDqqkyGLbO6MenLmZxtZpu4NHU_xP99qV1hQ9TlKVy--Xxzd7k941oQ81hJbxUpToHE1GCRKHBri8ZKLreoLNzlkpQ9jcdkdmSaeKPpDQZN0INVlW_A7d7lqyBDqpGF2hIYmWYW9Bpa7RPmUhAZC_yXVXPqkA3bg0XoL-b30WyyHAX_wxnimW29T3jjaDacBMEovATzc_io8_jStCEFiCqlnUFMxRnqPIpg6ocvl6CRWtU0AdagKpFbqVVPirN5P4TR88VXzlsOgVSwogyVoFyq9MojYTZ6XIzieXwJPtaVK2IN3tWVRedyBjv0g5bYcWX66YMgcJcQCrKwPrJurravNoGy4pzKnc7P2PVv-52_FXRg1mUFmQKlcH97X99MmM2ooIR5bivQbBKWqIPTYWV1_Kk486ypqMuqrfNt54B5a8xLFyUhrTbTZliOM9Nl7v8vtW41h28ndhxg)](https://mermaid.live/edit#pako:eNqNk99rwjAQx_-VI08OFIaPfRDqqkyGLbO6MenLmZxtZpu4NHU_xP99qV1hQ9TlKVy--Xxzd7k941oQ81hJbxUpToHE1GCRKHBri8ZKLreoLNzlkpQ9jcdkdmSaeKPpDQZN0INVlW_A7d7lqyBDqpGF2hIYmWYW9Bpa7RPmUhAZC_yXVXPqkA3bg0XoL-b30WyyHAX_wxnimW29T3jjaDacBMEovATzc_io8_jStCEFiCqlnUFMxRnqPIpg6ocvl6CRWtU0AdagKpFbqVVPirN5P4TR88VXzlsOgVSwogyVoFyq9MojYTZ6XIzieXwJPtaVK2IN3tWVRedyBjv0g5bYcWX66YMgcJcQCrKwPrJurravNoGy4pzKnc7P2PVv-52_FXRg1mUFmQKlcH97X99MmM2ooIR5bivQbBKWqIPTYWV1_Kk486ypqMuqrfNt54B5a8xLFyUhrTbTZliOM9Nl7v8vtW41h28ndhxg)

## Status transactie opvragen

[![Status transactie opvragen](https://mermaid.ink/img/pako:eNqNk8FuwjAMhl_FymmT4AV6QCoraAjRarRsGurFJKaNaJMuTdE2xLsvpas0bSosp8ixv9927BPjWhDzWE1vDSlOgcTMYJkqcKdCYyWXFSoLD4UkZf_aYzJHMp298xlPJp3Rg9qibWrQ1dFgRgruSrJgDaoauZVajaW470JDbQmMzHILeg99_DMWUhAZC_yHfPfqZDo9Dzahv0keo_ViOwv-hzPEc0tqgDeP1tNFEMzCazC_gHdwt09NB1caosrIlYmZGKAmUQQrP3y9Bo3UrqWJX00arHsZRi9Xs0x6DoFUsKMclaBCquxGkrCePW1mcRJfg89145rYgo9tZ9GpDGCnftAT71ybvv9BELgghHYq9hfW7WloRaBuOKf6qIsBuWiZKjZiJZkSpXDjfWodU2ZzKillnrsKNIeUpers_LCxOv5QnHnWNDRiTeVk-lVg3h6L2llJSKvNqtuXy9qMmFuBrda9z_kLygEdnw)](https://mermaid.live/edit#pako:eNqNk8FuwjAMhl_FymmT4AV6QCoraAjRarRsGurFJKaNaJMuTdE2xLsvpas0bSosp8ixv9927BPjWhDzWE1vDSlOgcTMYJkqcKdCYyWXFSoLD4UkZf_aYzJHMp298xlPJp3Rg9qibWrQ1dFgRgruSrJgDaoauZVajaW470JDbQmMzHILeg99_DMWUhAZC_yHfPfqZDo9Dzahv0keo_ViOwv-hzPEc0tqgDeP1tNFEMzCazC_gHdwt09NB1caosrIlYmZGKAmUQQrP3y9Bo3UrqWJX00arHsZRi9Xs0x6DoFUsKMclaBCquxGkrCePW1mcRJfg89145rYgo9tZ9GpDGCnftAT71ybvv9BELgghHYq9hfW7WloRaBuOKf6qIsBuWiZKjZiJZkSpXDjfWodU2ZzKillnrsKNIeUpers_LCxOv5QnHnWNDRiTeVk-lVg3h6L2llJSKvNqtuXy9qMmFuBrda9z_kLygEdnw)

## Historie opvragen

Om transparant te zijn, moeten alle __acties__ worden vastgelegd. De aanvrager kan ten allen tijde de history opvragen.

[![History opvragen](https://mermaid.ink/img/pako:eNqNkt1KxDAQhV9lyJVC9wV6sVBtxUW2xf4ILrkZmtk2bpvUNF3UZd_daCgo0sVcDWdOviE5c2K1FsRCNtLrRKqmWGJjsOcK3BnQWFnLAZWF206Ssn_1gsyRjNe9Z7VeezGEVo5WG0m-nWpLYGTTWtB7mD1P2ElBZCzUP0b4rkN5ZghVGlXlfZZvdkn8P5yhurWkFnh3WX6zieMkvQSLOngDV31oOpACRNXQ0SA2YoFaZhlso_QZ8uSxSoqyuETPhhY7h51_adXJl3Hp_dnD1W_fNVcsYD2ZHqVwCZ6-LnJmW-qJs9CVAs2BM67OzoeT1cW7qllozUQBmwaBdk6bhXvsRqeSkG7C1q_E92YEzKW803r2nD8BATa9xg)](https://mermaid.live/edit#pako:eNqNkt1KxDAQhV9lyJVC9wV6sVBtxUW2xf4ILrkZmtk2bpvUNF3UZd_daCgo0sVcDWdOviE5c2K1FsRCNtLrRKqmWGJjsOcK3BnQWFnLAZWF206Ssn_1gsyRjNe9Z7VeezGEVo5WG0m-nWpLYGTTWtB7mD1P2ElBZCzUP0b4rkN5ZghVGlXlfZZvdkn8P5yhurWkFnh3WX6zieMkvQSLOngDV31oOpACRNXQ0SA2YoFaZhlso_QZ8uSxSoqyuETPhhY7h51_adXJl3Hp_dnD1W_fNVcsYD2ZHqVwCZ6-LnJmW-qJs9CVAs2BM67OzoeT1cW7qllozUQBmwaBdk6bhXvsRqeSkG7C1q_E92YEzKW803r2nD8BATa9xg)
