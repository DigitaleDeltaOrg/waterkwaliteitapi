# Aanbieden: Bulk verwerking

Bulk-verwerking is niet iets dat ingebakken is in REST. Wegens volume van de data en de verwerkingstijd, is gekozen voor een asynchrone oplossing.
Toevoegen, updaten en verwijderen is toegestaan.
Updaten van meetobjecten is toegestaan. Updaten van monsters en metingen __niet__.

Dit om een aantal redenen:

- Metingen behoren immutable te zijn.
- Updaten van data, helemaal indien deze in een bepaalde structuur staan, is zeer inefficient en kan vaak niet in een bulk-operatie plaatsvinden.
- Ook de historie bijhouden wordt ingewikkeld.

Zijn monsters en metingen fout, dan dienen deze eerst verwijderd te worden, en daarna opnieuw ge&iuml;mporteerd.

Authenticeren gaat met de OAUTH2 Client Credential Flow, die wordt gebruikt als machine-to-machine koppeling.
De API implementatie dient het inlog-account te associëren met een bepaalde organisatie en op basis daarvan te valideren of het verzoek terecht is.

Verwerking zal niet meteen gebeuren. Daarom kan de client een status bij de server opvragen.

Valideren is de eerste fase van verwerking. Pas wanneer de bulk-content volledig gevalideerd is, kan er daadwerkelijk worden ge&iuml;mporteerd.

Alle bulk-operaties worden gelogged. Zie [Logging](logging.md).

[Fouten in validatie](validatie.md#validatiefouten) worden ook gestandaardiseerd.

*Belangrijk: Zowel het toevoegen als het verwijderen van data gebeurd met een POST operatie. De reden daarvoor is dat in REST voor een DELETE operatie geen gedefiëerde semantiek bepaald voor die situatie. OAS 3.01 ondersteund daarom geen DELETE met request body.
Een POST lijkt semantisch niet correct, voor deze situatie, maar dat zijn andere oplossingen ook niet.*

## Bulk data toevoegen

[![Bulk toevoegen](https://mermaid.ink/img/pako:eNqNksFqwzAMhl9F-LRB-wI5FLImYz002ZpksJKLZqupaWJ3jlK2lb77vHmFQUmZTuLXr8-GX0chrSIRiZ7eBjKSEo2Nw6424GuPjrXUezQM81aT4Uu9IHcgF_Tgmc5mQYzgdWh3oE1P7nczs0zgdLNlsBs4256x1Yq8CeSfV8LU0wI2giqLq_IhXy3WafI_nCO5ZTIjvPt8dbdIkjS7BotbeAfffVrakQFE09DBITZqhFrmOSzj7AVW6VOVFmVx9asBDGypZ88eYcbzefpYpskNOzQ9StbWTLW6rY2YiI5ch1r5EI_f67XgLXVUi8i3Ct2uFrU5eR8ObIsPI0XEbqCJGPYK-Ry4iDbY9l4lpdm6ZbiKn-OYCB_02tqz5_QFys2-Cw)](https://mermaid.live/edit#pako:eNqNksFqwzAMhl9F-LRB-wI5FLImYz002ZpksJKLZqupaWJ3jlK2lb77vHmFQUmZTuLXr8-GX0chrSIRiZ7eBjKSEo2Nw6424GuPjrXUezQM81aT4Uu9IHcgF_Tgmc5mQYzgdWh3oE1P7nczs0zgdLNlsBs4256x1Yq8CeSfV8LU0wI2giqLq_IhXy3WafI_nCO5ZTIjvPt8dbdIkjS7BotbeAfffVrakQFE09DBITZqhFrmOSzj7AVW6VOVFmVx9asBDGypZ88eYcbzefpYpskNOzQ9StbWTLW6rY2YiI5ch1r5EI_f67XgLXVUi8i3Ct2uFrU5eR8ObIsPI0XEbqCJGPYK-Ry4iDbY9l4lpdm6ZbiKn-OYCB_02tqz5_QFys2-Cw)

## Bulk verwijderen

[![Bulk verwijderen](https://mermaid.ink/img/pako:eNqNk91uwjAMhV_FyhWT4AV6gVRo0dBEu0HZNNQbk5iS0SYsTdkP4t2X0lXaNFGWq8g5-U5sx0fGtSDmsZJeK1KcAomZwSJV4NYejZVc7lFZGOeSlP0bX5A5kGnijWYwHDZBD9ZVvgO3e5MvggypRhZpS2BktrWgN9BqHzGXgshY4D-smlOHbNgeLCN_mdzG8-kqDP6HM8S3tvX-w5vE89E0CMKoC-bn8F7n8alpRwoQVUYHg5iJC9QkjmHmR89d0Fita5oAa1CVyK3UaiDFxbzvovip85VJyyGQCta0RSUolyq78kiYhw_LcJEsuuATXbki1uBDXVl0LhewIz9oiT1Xpu8-CAJ3CaEgC5sz6-Zq-2oTKCvOqTzo_IKdPx6H90kY9H6X0dFZnxVkCpTCffBjfT1ldksFpcxzW4Fml7JUnZwOK6sXH4ozz5qK-qzaO_N2GJi3wbx0URLSajNrJuY8OH3mhmCldas5fQGyUR4F)](https://mermaid.live/edit#pako:eNqNk91uwjAMhV_FyhWT4AV6gVRo0dBEu0HZNNQbk5iS0SYsTdkP4t2X0lXaNFGWq8g5-U5sx0fGtSDmsZJeK1KcAomZwSJV4NYejZVc7lFZGOeSlP0bX5A5kGnijWYwHDZBD9ZVvgO3e5MvggypRhZpS2BktrWgN9BqHzGXgshY4D-smlOHbNgeLCN_mdzG8-kqDP6HM8S3tvX-w5vE89E0CMKoC-bn8F7n8alpRwoQVUYHg5iJC9QkjmHmR89d0Fita5oAa1CVyK3UaiDFxbzvovip85VJyyGQCta0RSUolyq78kiYhw_LcJEsuuATXbki1uBDXVl0LhewIz9oiT1Xpu8-CAJ3CaEgC5sz6-Zq-2oTKCvOqTzo_IKdPx6H90kY9H6X0dFZnxVkCpTCffBjfT1ldksFpcxzW4Fml7JUnZwOK6sXH4ozz5qK-qzaO_N2GJi3wbx0URLSajNrJuY8OH3mhmCldas5fQGyUR4F)

## Status transactie opvragen

[![Status transactie opvragen](https://mermaid.ink/img/pako:eNqNk8FuwjAMhl_FymmT4AV6QCoraAjRarRsGurFJKaNaJMuTdE2xLsvpas0bSosp8ixv9927BPjWhDzWE1vDSlOgcTMYJkqcKdCYyWXFSoLD4UkZf_aYzJHMp298xlPJp3Rg9qibWrQ1dFgRgruSrJgDaoauZVajaW470JDbQmMzHILeg99_DMWUhAZC_yHfPfqZDo9Dzahv0keo_ViOwv-hzPEc0tqgDeP1tNFEMzCazC_gHdwt09NB1caosrIlYmZGKAmUQQrP3y9Bo3UrqWJX00arHsZRi9Xs0x6DoFUsKMclaBCquxGkrCePW1mcRJfg89145rYgo9tZ9GpDGCnftAT71ybvv9BELgghHYq9hfW7WloRaBuOKf6qIsBuWiZKjZiJZkSpXDjfWodU2ZzKillnrsKNIeUpers_LCxOv5QnHnWNDRiTeVk-lVg3h6L2llJSKvNqtuXy9qMmFuBrda9z_kLygEdnw)](https://mermaid.live/edit#pako:eNqNk8FuwjAMhl_FymmT4AV6QCoraAjRarRsGurFJKaNaJMuTdE2xLsvpas0bSosp8ixv9927BPjWhDzWE1vDSlOgcTMYJkqcKdCYyWXFSoLD4UkZf_aYzJHMp298xlPJp3Rg9qibWrQ1dFgRgruSrJgDaoauZVajaW470JDbQmMzHILeg99_DMWUhAZC_yHfPfqZDo9Dzahv0keo_ViOwv-hzPEc0tqgDeP1tNFEMzCazC_gHdwt09NB1caosrIlYmZGKAmUQQrP3y9Bo3UrqWJX00arHsZRi9Xs0x6DoFUsKMclaBCquxGkrCePW1mcRJfg89145rYgo9tZ9GpDGCnftAT71ybvv9BELgghHYq9hfW7WloRaBuOKf6qIsBuWiZKjZiJZkSpXDjfWodU2ZzKillnrsKNIeUpers_LCxOv5QnHnWNDRiTeVk-lVg3h6L2llJSKvNqtuXy9qMmFuBrda9z_kLygEdnw)

## Historie opvragen

Om transparant te zijn, moeten alle __acties__ worden vastgelegd. De aanvrager kan ten allen tijde de history opvragen.

[![History opvragen](https://mermaid.ink/img/pako:eNqNkt1KxDAQhV9lyJVC9wV6sVBtxUW2xf4ILrkZmtk2bpvUNF3UZd_daCgo0sVcDWdOviE5c2K1FsRCNtLrRKqmWGJjsOcK3BnQWFnLAZWF206Ssn_1gsyRjNe9Z7VeezGEVo5WG0m-nWpLYGTTWtB7mD1P2ElBZCzUP0b4rkN5ZghVGlXlfZZvdkn8P5yhurWkFnh3WX6zieMkvQSLOngDV31oOpACRNXQ0SA2YoFaZhlso_QZ8uSxSoqyuETPhhY7h51_adXJl3Hp_dnD1W_fNVcsYD2ZHqVwCZ6-LnJmW-qJs9CVAs2BM67OzoeT1cW7qllozUQBmwaBdk6bhXvsRqeSkG7C1q_E92YEzKW803r2nD8BATa9xg)](https://mermaid.live/edit#pako:eNqNkt1KxDAQhV9lyJVC9wV6sVBtxUW2xf4ILrkZmtk2bpvUNF3UZd_daCgo0sVcDWdOviE5c2K1FsRCNtLrRKqmWGJjsOcK3BnQWFnLAZWF206Ssn_1gsyRjNe9Z7VeezGEVo5WG0m-nWpLYGTTWtB7mD1P2ElBZCzUP0b4rkN5ZghVGlXlfZZvdkn8P5yhurWkFnh3WX6zieMkvQSLOngDV31oOpACRNXQ0SA2YoFaZhlso_QZ8uSxSoqyuETPhhY7h51_adXJl3Hp_dnD1W_fNVcsYD2ZHqVwCZ6-LnJmW-qJs9CVAs2BM67OzoeT1cW7qllozUQBmwaBdk6bhXvsRqeSkG7C1q_E92YEzKW803r2nD8BATa9xg)
